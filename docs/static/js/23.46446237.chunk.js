webpackJsonp([23],{954:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={cssText:":local {\n    .container{\n        background: #a27373;\n\t\twidth: 100%;\n\t\tpadding: 20px;\n\t}\n\t.contentContainer{\n\t\tmargin-left: 20px;\n\t\tbackground: #a78787;\n\t\twidth: 800px;\n\t\theight: 400px;\n\t\tposition: relative;\n\t\t.textItem{\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\tdisplay: inline-block;\n\t\t\tbackground: #fff;\n\t\t\tpadding: 5px;\n\t\t\tmargin-bottom: 5px;\n\t\t\tmargin-right: 5px;\n\t\t\tborder: 1px solid #ddd;\n\t\t\tcursor: move;\n\t\t\tuser-select:none;\n\t\t\ttext-align: center;\n\t\t\tcontent{\n\t\t\t\tbackground: #ddd;\n\t\t\t\tpadding: 5px;\n\t\t\t}\n\t\t}\n\t\t.tableItem{\n\t\t\tcursor: move;\n\t\t\twidth: 100%;\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\tdisplay:block;\n\t\t\tpadding: 20px;\n\t\t\tbackground: #ddd;\n\t\t\ttext-align: center;\t\n\t\t\tp{\n\t\t\t\tmargin-bottom: 0;\n\t\t\t}\n\t\t}\n\t\t.qrcodeItem{\n\t\t\tcursor: move;\n\t\t\tdisplay: inline-block;\n\t\t\twidth: 100%;\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\tpadding: 5px;\n\t\t\tbackground: #fff;\n\t\t\twidth: 50px;\n\t\t\theight: 50px;\n\t\t\tcontent{\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tbackground: #ddd;\t\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\t\n\t\t\t}\n\t\t}\n\t}\n    .toolContainer{\n\t\tpadding: 10px;\n\t\tfloat: left;\n\t\tuser-select:none;\n\t\tbox-sizing: border-box;\n\t\tborder:  1px dashed #999 ;\n\t\tborder-bottom: none;\n\t\twidth: 150px;\n\t\tz-index: 2;\n\t\t.toolItem{\n\t\t\tdisplay: inline-block;\n\t\t\tbackground: #fff;\n\t\t\tpadding: 10px;\n\t\t\tmargin-bottom: 5px;\n\t\t\tmargin-right: 5px;\n\t\t\tborder: 1px solid #ddd;\n\t\t\tcursor: move;\n\t\t\tuser-select:none;\n\t\t\ttext-align: center;\n\t\t}\n\t}\n}\n\n:global{\n\t.ant-popover-inner-content{\n\t\tmin-width: 400px;\n\t}\n}",javaScriptText:"\nimport React from \"react\";\nimport style from \"./index.scss\";\nimport { Popover, Form, Button, Input, Slider, InputNumber, Radio } from 'antd';\n\nconst FormItem = Form.Item;\nconst RadioGroup = Radio.Group;\nconst Draggabilly = require('draggabilly');\n\nclass DraggabillyComponent extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\ttoolList: [\n\t\t\t\t{ title: '\u81ea\u5b9a\u4e49\u6587\u672c', type: 'text', name: 'text', content: '' },\n\t\t\t\t{ title: '\u8868\u683c\u533a\u57df', type: 'table', name: 'table' },\n\t\t\t\t{ title: '\u4e8c\u7ef4\u7801\u533a\u57df', type: 'qrcode', name: 'qrcode' },\n\t\t\t],\n\t\t\tactiveList: [],\n\t\t\ttoolDraggies: [],\n\t\t\tactiveDraggies: [],\n\t\t};\n\t}\n\n\tcomponentDidMount () {\n\t\tlet that = this;\n\t\tlet contentDom = document.getElementById('contentContainer');\n\t\tdocument.querySelectorAll(\"#toolContainer [role = 'toolItem']\").forEach((item, index) => {\n\t\t\tlet toolItem = this.state.toolList[index];\n\t\t\tlet type = toolItem.type;\n\t\t\tlet toolDraggie = new Draggabilly(item, {})\n\t\t\tthis.setState({ toolDraggies: [...this.state.toolDraggies, toolDraggie] })\n\t\t\tlet originDelta = { y: item.offsetTop - contentDom.offsetTop, x: item.offsetLeft - contentDom.offsetLeft }\n\n\t\t\ttoolDraggie.on('dragStart', function (event, pointer) {\n\t\t\t\t//\u6837\u5f0f\u5904\u7406\n\t\t\t\titem.style.opacity = 0.65;\n\t\t\t\titem.style.zIndex = 10;\n\t\t\t\t//\u8ba1\u7b97\u521d\u59cb\u504f\u79fb\n\n\t\t\t})\n\n\t\t\ttoolDraggie.on('dragEnd', function (event, pointer) {\n\t\t\t\t//\u6837\u5f0f\u5904\u7406\n\t\t\t\titem.style.opacity = 1;\n\t\t\t\titem.style.zIndex = '';\n\n\t\t\t\tif (that.isOverlap(item, document.getElementById('contentContainer'))) {\n\t\t\t\t\t// \u8ba1\u7b97\u6700\u7ec8\u504f\u79fb\u7684\u76f8\u5bf9\u5750\u6807 \u3010\u6700\u7ec8\u504f\u79fb\u7684\u5750\u6807\uff08\u4ee5\u5bb9\u5668\u7684\u5de6\u4e0a\u89d2\u4e3a\u8d77\u70b9\uff09\uff0c\u7b49\u4e8e\u5de5\u5177\u7ec4\u4ef6\u9759\u6b62\u65f6\u76f8\u5bf9\u539f\u70b9\u7684\u5750\u6807\u4e0e\u5de5\u5177\u88ab\u62d6\u52a8\u65b9\u5411\u7684\u77e2\u91cf\u5408\u3011\n\t\t\t\t\tlet finalDelta = { x: toolDraggie.position.x, y: toolDraggie.position.y }\n\t\t\t\t\tlet relativePosition = {\n\t\t\t\t\t\tx: (finalDelta.x + originDelta.x > 0 && type != 'table') ? finalDelta.x + originDelta.x : 0,\n\t\t\t\t\t\ty: finalDelta.y + originDelta.y > 0 ? finalDelta.y + originDelta.y : 0,\n\t\t\t\t\t}\n\t\t\t\t\t// \u751f\u6210\u521d\u59cb\u6570\u636e\n\t\t\t\t\tlet timestamp = new Date().getTime();\n\t\t\t\t\tlet newActiveList = [...that.state.activeList, {\n\t\t\t\t\t\tid: timestamp,\n\t\t\t\t\t\tfont_size: 12,\n\t\t\t\t\t\tsize: 5,\n\t\t\t\t\t\tlockDirection: type == 'table' ? 'y' : 'free',\n\t\t\t\t\t\tx: relativePosition.x,\n\t\t\t\t\t\ty: relativePosition.y,\n\t\t\t\t\t\t...toolItem,\n\t\t\t\t\t}]\n\n\t\t\t\t\t//\u6fc0\u6d3b\u7ec4\u4ef6\n\t\t\t\t\tthat.setState({ activeList: newActiveList })\n\t\t\t\t\tlet activeDom = document.getElementById(timestamp);\n\t\t\t\t\tlet activeDraggie = new Draggabilly(activeDom, { containment: '#contentContainer' })\n\t\t\t\t\tthat.setState({ activeDraggies: [...that.state.activeDraggies, activeDraggie] })\n\t\t\t\t\tactiveDraggie.setPosition(relativePosition.x, relativePosition.y)\n\t\t\t\t\tlet _index = that.state.activeList.length - 1\n\n\t\t\t\t\t// \u540c\u6b65\u4fee\u6539state\u4e2d\u7684\u4f4d\u7f6e\u503c\n\t\t\t\t\tactiveDraggie.on('dragEnd', function (event, pointer) {\n\t\t\t\t\t\tthat.state.activeList[_index].x = activeDraggie.position.x;\n\t\t\t\t\t\tthat.state.activeList[_index].y = activeDraggie.position.y;\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// \u6062\u590d\u5de5\u5177\u63a7\u4ef6\u7684\u4f4d\u7f6e\n\t\t\t\ttoolDraggie.setPosition(0, 0)\n\n\t\t\t})\n\t\t})\n\t}\n\n\t// \u5378\u8f7d\u65f6\u53d6\u6d88\u76d1\u542c\n\tcomponentWillUnmount () {\n\t\tthis.clear(this.state.activeDraggies)\n\t\tthis.clear(this.state.toolDraggies)\n\t}\n\n\t// \u9500\u6bc1\u76d1\u542c\n\tclear (draggieList) {\n\t\tdraggieList.forEach(item => {\n\t\t\titem.destroy()\n\t\t})\n\t}\n\n\t//\u5224\u65ad\u7ec4\u4ef6\u662f\u5426\u88ab\u62d6\u5165\u6709\u6548\u5de5\u4f5c\u533a\u57df\n\tisOverlap (objOne, objTwo) {\n\t\tlet x1 = objOne.offsetLeft;\n\t\tlet y1 = objOne.offsetTop;\n\t\tlet x2 = x1 + objOne.offsetWidth;\n\t\tlet y2 = y1 + objOne.offsetHeight;\n\n\t\tlet x3 = objTwo.offsetLeft;\n\t\tlet y3 = objTwo.offsetTop;\n\t\tlet x4 = x3 + objTwo.offsetWidth;\n\t\tlet y4 = y3 + objTwo.offsetHeight;\n\n\t\tlet zx = Math.abs(x1 + x2 - x3 - x4);\n\t\tlet x = Math.abs(x1 - x2) + Math.abs(x3 - x4);\n\t\tlet zy = Math.abs(y1 + y2 - y3 - y4);\n\t\tlet y = Math.abs(y1 - y2) + Math.abs(y3 - y4);\n\t\treturn (zx <= x && zy <= y);\n\t}\n\n\n\t// \u5bf9\u7ec4\u4ef6\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c\u7684\u90e8\u5206\n\tonItemValueChange (value, index, key) {\n\t\t//\u4fee\u6539\u503c\n\t\tthis.state.activeList[index][key] = value\n\t\t//\u89e6\u53d1dom\u66f4\u65b0\n\t\tthis.setState({\n\t\t\tactiveList: this.state.activeList\n\t\t})\n\t\t//\u9700\u8981\u624b\u52a8\u53d8\u66f4\u7684\u9009\u9879\n\t\tlet dom = document.getElementById(this.state.activeList[index].id);\n\t\tif (key == 'font_size') {\n\t\t\tdom.style.fontSize = value + 'px'\n\t\t} else if (key == 'lockDirection') {\n\t\t\tthis.state.activeDraggies[index].options.axis = this.state.activeList[index].lockDirection == 'free' ? '' : this.state.activeList[index].lockDirection\n\t\t} else if (key == 'size') {\n\t\t\tdom.style.width = value * 10 + 'px'\n\t\t\tdom.style.height = value * 10 + 'px'\n\t\t}\n\t}\n\n\t//\u5220\u9664\u7ec4\u4ef6\n\tdeleteItem (index) {\n\t\tconsole.log(index)\n\t\tthis.state.activeList.splice(index, 1);\n\t\tthis.state.activeDraggies[index].destroy();\n\t\tthis.state.activeDraggies.splice(index, 1);\n\t\tthis.setState({\n\t\t\tactiveList: this.state.activeList\n\t\t})\n\t}\n\n\n\t// \u6e32\u67d3\u7f16\u8f91\u9762\u677f\n\teditToolRender (item, index) {\n\t\tconst formItemLayout = {\n\t\t\tlabelCol: {\n\t\t\t\txs: { span: 24 },\n\t\t\t\tsm: { span: 6 },\n\t\t\t},\n\t\t\twrapperCol: {\n\t\t\t\txs: { span: 24 },\n\t\t\t\tsm: { span: 16 },\n\t\t\t},\n\t\t};\n\t\treturn (\n\t\t\t<Form style={{ overflow: \"hidden\" }}>\n\t\t\t\t<FormItem label=\"\u7c7b\u578b\" {...formItemLayout} style={{ marginBottom: 5 }}> <Input value={item.title} placeholder='\u6587\u672c\u6807\u9898' disabled={item.type != 'text'} onChange={(e) => this.onItemValueChange.bind(this)(e.target.value, index, 'title')} /></FormItem>\n\t\t\t\t<FormItem label=\"\u5185\u5bb9\" {...formItemLayout} style={{ marginBottom: 5 }}> <Input value={item.content} placeholder='\u6587\u672c\u5185\u5bb9' disabled={item.type != 'text'} onChange={(e) => this.onItemValueChange.bind(this)(e.target.value, index, 'content')} /></FormItem>\n\t\t\t\t<FormItem label=\"\u5b57\u4f53\u5927\u5c0f\" {...formItemLayout} style={{ marginBottom: 5 }}> <Slider min={8} max={24} value={item.font_size} disabled={item.type != 'text'} onChange={(value) => this.onItemValueChange.bind(this)(value, index, 'font_size')}></Slider></FormItem>\n\t\t\t\t<FormItem label=\"\u5c3a\u5bf8\" {...formItemLayout} style={{ marginBottom: 5 }}> <Slider min={4} max={10} value={item.size} disabled={item.type != 'qrcode'} onChange={(value) => this.onItemValueChange.bind(this)(value, index, 'size')}></Slider></FormItem>\n\t\t\t\t<FormItem label=\"\u79fb\u52a8\u65b9\u5411\" {...formItemLayout} style={{ marginBottom: 5 }}>\n\t\t\t\t\t<RadioGroup onChange={(e) => this.onItemValueChange.bind(this)(e.target.value, index, 'lockDirection')} value={item.lockDirection}>\n\t\t\t\t\t\t<Radio value='free' disabled={item.type == 'table'}>\u81ea\u7531</Radio>\n\t\t\t\t\t\t<Radio value='x' disabled={item.type == 'table'}>\u6c34\u5e73</Radio>\n\t\t\t\t\t\t<Radio value='y' >\u5782\u76f4</Radio>\n\t\t\t\t\t</RadioGroup>\n\t\t\t\t</FormItem>\n\t\t\t\t<Button style={{ float: 'right' }} type=\"danger\" onClick={(e) => this.deleteItem.bind(this)(index)}>\u5220\u9664</Button>\n\t\t\t</Form >)\n\t}\n\n\n\trender () {\n\n\t\treturn (<div className={style.container}>\n\t\t\t<div data-flex='main:start cross:center'>\n\t\t\t\t{/* \u9009\u9879\u5217\u8868 */}\n\t\t\t\t<ul className={style.toolContainer} flex='dir:top main:center cross:center' id='toolContainer'>\n\t\t\t\t\t{this.state.toolList.map(item => {\n\t\t\t\t\t\treturn (<li className={style.toolItem} role='toolItem' key={item.name}>{item.title || '\u6807\u9898'}</li>)\n\t\t\t\t\t})}\n\t\t\t\t</ul>\n\t\t\t\t{/* \u753b\u5e03 */}\n\t\t\t\t<div className={style.contentContainer} id='contentContainer'>\n\t\t\t\t\t<ul className={style.activeList}>\n\t\t\t\t\t\t{this.state.activeList.map((item, index) => {\n\t\t\t\t\t\t\t// \u8fd9\u91cc\u662f\u628a\u624b\u533a\u57df\u7684\u6e32\u67d3\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\t\tcontent={this.editToolRender(item, index)}\n\t\t\t\t\t\t\t\t\ttrigger=\"click\"\n\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<li className={style[`${item.type}Item`]} id={item.id}>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\titem.type == 'text' ?\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{item.title}\uff1a</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<content>{item.content || '<-- \u6587\u672c\u5185\u5bb9 --\x3e'}</content>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t{item.type == 'table' ? <p>{'<-- \u8868\u683c\u533a\u57df --\x3e'}</p> : null}\n\t\t\t\t\t\t\t\t\t\t{item.type == 'qrcode' ? <content></content> : null}\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>)\n\t}\n}\n\n\nexport default DraggabillyComponent;\n\n  "}}});
//# sourceMappingURL=23.46446237.chunk.js.map