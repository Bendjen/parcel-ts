{"version":3,"sources":["project/flip-card/demo/index.jsx","webpack:///./src/project/flip-card/demo/index.scss?6a2c","project/flip-card/demo/index.scss"],"names":["transArr","activeIndex","activeList","rectInfo","updateStatus","zIndex","cardIndex","listData","Array","fill","map","item","index","getArrByLen","len","Card","listRef","React","createRef","state","animateStatus","inputValue","Component","this","updateAnimateStatus","_this2","stepIndex","forEach","itemEle","getBoundingClientRect","left","top","some","v","k","setState","length","setTimeout","type","currentIndex","prototype","slice","call","current","children","newListData","concat","filter","value","e","target","console","log","_this3","_state","__WEBPACK_IMPORTED_MODULE_0_react___default","a","createElement","className","ref","key","style","Object","assign","transform","onClick","updateItem","bind","title","onChange","inputIndex","content","__webpack_require__","module","i","options","hmr","locals","exports","undefined","push"],"mappings":"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","file":"static/js/21.883930c5.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.scss'\r\n\r\nlet transArr = null\r\nlet activeIndex = 100000\r\nlet activeList = null\r\nlet rectInfo = null\r\n// 0标识增加，1标识删除\r\nlet updateStatus = 0\r\n// 用于调整 card层级，让排列层级变化的 card在动画过程中不被其他 card遮盖\r\nlet zIndex = 1\r\nlet cardIndex = 2\r\n// 生成初始测试数据\r\nlet listData = Array(cardIndex).fill().map((item, index) => ({\r\n  index\r\n}))\r\n// 生成一个二维数组\r\nfunction getArrByLen(len) {\r\n  return Array(len).fill().map(() => [0, 0])\r\n}\r\n\r\nexport default class Card extends React.Component {\r\n  listRef = React.createRef()\r\n  state = {\r\n    // 用于标记动画的状态\r\n    animateStatus: 0,\r\n    listData,\r\n    inputValue: 0\r\n  }\r\n  componentDidUpdate () {\r\n    // card 更新\r\n    this.updateAnimateStatus()\r\n  }\r\n  updateAnimateStatus () {\r\n    if (this.state.animateStatus === 1) {\r\n      // Last + Invert\r\n      const stepIndex = updateStatus === 0 ? 1 : 0\r\n      activeList.forEach((itemEle, index) => {\r\n        rectInfo = itemEle.getBoundingClientRect()\r\n        transArr[index + stepIndex][0] = transArr[index + stepIndex][0] - rectInfo.left\r\n        transArr[index + stepIndex][1] = transArr[index + stepIndex][1] - rectInfo.top\r\n        // 横排的层级变化，则进行 z-index的提升以获得更好的视觉体验\r\n        if (transArr[index + stepIndex][1] !== 0) {\r\n          this.state.listData.some((v, k) => {\r\n            if (index + stepIndex + activeIndex === k) {\r\n              v.zIndex = zIndex++\r\n              return true\r\n            }\r\n            return false\r\n          })\r\n        }\r\n      })\r\n      this.setState({\r\n        animateStatus: 2\r\n      })\r\n    } else if (this.state.animateStatus === 2) {\r\n      // Play\r\n      // 重置\r\n      transArr = getArrByLen(this.state.listData.length)\r\n      setTimeout(() => {\r\n        this.setState({\r\n          animateStatus: 3\r\n        })\r\n      }, 0)\r\n    }\r\n  }\r\n  updateItem (type, currentIndex) {\r\n    updateStatus = type\r\n    activeIndex = currentIndex\r\n    // 位置需要进行改变的节点（可以大致认为位于当前变化节点之前的所有节点，位置完全不变）\r\n    // 如果是删除操作，则 slice的起始坐标需要往后移一位\r\n    activeList = Array.prototype.slice.call(this.listRef.current.children).slice(activeIndex + (updateStatus === 0 ? 0 : 1))\r\n    // 如果是增加操作，则 transArr2的长度应该比 activeList 多 1\r\n    const stepIndex = updateStatus === 0 ? 1 : 0\r\n    transArr = getArrByLen(activeList.length + stepIndex)\r\n    // First\r\n    activeList.forEach((itemEle, index) => {\r\n      rectInfo = itemEle.getBoundingClientRect()\r\n      transArr[index + stepIndex][0] = rectInfo.left\r\n      transArr[index + stepIndex][1] = rectInfo.top\r\n    })\r\n    let newListData = null\r\n    if (updateStatus === 0) {\r\n      newListData = this.state.listData.slice(0, activeIndex).concat({\r\n        index: cardIndex++\r\n      }, this.state.listData.slice(activeIndex))\r\n    } else {\r\n      newListData = this.state.listData.filter((value, index) => index !== activeIndex)\r\n    }\r\n    this.setState({\r\n      animateStatus: 1,\r\n      listData: newListData\r\n    })\r\n  }\r\n  inputIndex (e) {\r\n    let inputValue = +e.target.value\r\n    if (inputValue > this.state.listData.length) {\r\n      console.log('新增item的 index不能超过 listData的长度')\r\n      inputValue = this.state.listData.length\r\n    }\r\n    this.setState({\r\n      inputValue,\r\n      animateStatus: 0\r\n    })\r\n  }\r\n  render () {\r\n    const { animateStatus, inputValue } = this.state\r\n    return (\r\n      <div>\r\n        <ul className=\"card-list\" ref={this.listRef}>\r\n          {\r\n            this.state.listData.map((item, index) => (\r\n              <li\r\n                key={item.index}\r\n                className={`card-item${index >= activeIndex && animateStatus === 3 ? ' active' : ''}`}\r\n                style={\r\n                  Object.assign({ zIndex: item.zIndex || 'auto' }, index >= activeIndex && animateStatus > 1\r\n                    ? {transform: `translate(${transArr[index - activeIndex][0]}px, ${transArr[index - activeIndex][1]}px)`}\r\n                    : null)\r\n                }>\r\n                  <div className=\"card-title\">\r\n                    <h3>Title - {item.index}</h3>\r\n                    <span onClick={this.updateItem.bind(this, 1, index)} className=\"icon-btn\" title=\"点击删除\">Delete</span>\r\n                  </div>\r\n                  <div className=\"card-content\">\r\n                    <p className=\"content\">content - {item.index}</p>\r\n                    <p className=\"content\">content - {item.index}</p>\r\n                    <p className=\"content\">content - {item.index}</p>\r\n                  </div>\r\n                </li>\r\n            ))\r\n          }\r\n        </ul>\r\n        <hr/>\r\n        <div className=\"update-count\">\r\n          <input onChange={this.inputIndex.bind(this)} value={inputValue} type=\"number\" />\r\n          <button onClick={this.updateItem.bind(this, 0, inputValue)}>增加</button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/project/flip-card/demo/index.jsx","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/project/flip-card/demo/index.scss\n// module id = 1775\n// module chunks = 21","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"body {\\n  background-color: #ececec; }\\n\\nh3, p {\\n  margin: 0; }\\n\\n.card-item {\\n  position: relative;\\n  display: inline-block;\\n  margin-left: 30px;\\n  width: 260px;\\n  overflow: hidden;\\n  border-radius: 10px;\\n  border: 1px solid #e8e8e8;\\n  background-color: #fff; }\\n\\n.card-item:hover {\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.09);\\n  border-color: rgba(0, 0, 0, 0.09); }\\n\\n.card-item.active {\\n  transition: transform 1s ease; }\\n\\n.card-title {\\n  padding: 16px 24px;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  border-bottom: 1px solid #e8e8e8; }\\n\\n.card-title h3 {\\n  display: inline-block; }\\n\\n.card-content {\\n  padding: 24px; }\\n\\n.icon-btn {\\n  float: right;\\n  font-size: 14px;\\n  color: #1890ff;\\n  cursor: pointer; }\\n\\n.update-count {\\n  text-align: center; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/sass-loader/lib/loader.js!./src/project/flip-card/demo/index.scss\n// module id = 1776\n// module chunks = 21"],"sourceRoot":""}