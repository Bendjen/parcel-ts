{"version":3,"sources":["project/flip-preview/demo/index.jsx","webpack:///./src/project/flip-preview/demo/index.scss?b5ea","project/flip-preview/demo/index.scss"],"names":["first","left","top","last","Flip","props","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","previewItem","bind","hideLayer","transEnd","previewBlock","React","createRef","state","pickItem","width","height","color","preview","animation","blockList","Array","fill","map","item","getWidth","getHeight","getColor","Component","_this2","lastRect","current","getBoundingClientRect","setTimeout","setState","Math","round","random","toString","substr","index","e","firstRect","target","_this3","_state","console","log","__WEBPACK_IMPORTED_MODULE_0_react___default","a","createElement","style","overflow","data-flex","key","className","blockItem","onClick","background","layer","transition","onTransitionEnd","opacity","putPositionItem","ref","transform","content","__webpack_require__","module","i","options","hmr","locals","exports","undefined","push"],"mappings":"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","file":"static/js/20.b1e04ff3.chunk.js","sourcesContent":["import React from \"react\"\r\nimport style from './index.scss'\r\n\r\nconst first = { left: 0, top: 0 };\r\nconst last = { left: 0, top: 0 };\r\n\r\nclass Flip extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.previewItem = this.previewItem.bind(this)\r\n    this.hideLayer = this.hideLayer.bind(this)\r\n    this.transEnd = this.transEnd.bind(this)\r\n    this.previewBlock = React.createRef()\r\n    this.state = {\r\n      pickItem: {\r\n        width: 300,\r\n        height: 300,\r\n        color: 'd3d3d3'\r\n      },\r\n      preview: false,\r\n      animation: 0,   // 0 : 关闭  0.5 ：预览开启动画 1 ：开启 -0.5 : 预览关闭动画  \r\n      blockList: new Array(5).fill(null).map(item => {\r\n        return {\r\n          width: this.getWidth(),\r\n          height: this.getHeight(),\r\n          color: this.getColor()\r\n        }\r\n      })\r\n    }\r\n  }\r\n  componentDidUpdate() {\r\n    // 如果preview已经切换到true\r\n    // 获取dom中的last位置\r\n    if (this.state.preview && this.state.animation === 0) {\r\n      const lastRect = this.previewBlock.current.getBoundingClientRect()\r\n      last.left = lastRect.left\r\n      last.top = lastRect.top\r\n      // 下一帧切换到预览开启动画\r\n      setTimeout(() => {\r\n        this.setState({ animation: 0.5 })\r\n      }, 0)\r\n    } else if (!this.state.preview && this.state.animation !== 0) {\r\n      // 如果preview已经切换到false\r\n      // dom已经消失\r\n      // 将动画状态切换回已关闭\r\n      setTimeout(() => {\r\n        this.setState({ animation: 0 })\r\n      }, 0)\r\n    }\r\n  }\r\n  transEnd() {\r\n    if (this.state.animation === 0.5) {\r\n      this.setState({ animation: 1 })\r\n    } else if (this.state.animation === -0.5) {\r\n      this.setState({ animation: 0, preview: false })\r\n    }\r\n  }\r\n  getWidth() {\r\n    return Math.round(Math.random() * 120 + 80)\r\n  }\r\n  getHeight() {\r\n    return Math.round(Math.random() * 240 + 120)\r\n  }\r\n  getColor() {\r\n    return ('00000' + (Math.random() * 0x1000001).toString(16)).substr(-6)\r\n  }\r\n  previewItem(index, e) {\r\n    if (!this.state.preview) {\r\n      const firstRect = e.target.getBoundingClientRect()\r\n      this.setState({\r\n        preview: true,\r\n        pickItem: this.state.blockList[index],\r\n      })\r\n      first.left = firstRect.left\r\n      first.top = firstRect.top\r\n      // console.log('first',first)\r\n    }\r\n  }\r\n  hideLayer() {\r\n    if (this.state.preview) {\r\n      this.setState({ animation: -0.5 });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { animation, preview, blockList, pickItem } = this.state\r\n    console.log(animation)\r\n    return (\r\n      <div style={{ overflow: 'visible' }}>\r\n        <ul data-flex=\"main:center cross:bottom\">\r\n          {blockList.map((item, index) => {\r\n            return (<li key={index} data-flex='main:center cross:center' className={style.blockItem} onClick={this.previewItem.bind(this, index)}\r\n              style={{ background: `#${item.color}`, width: item.width, height: item.height, }}>{item.width} X {item.height}</li>)\r\n          })}\r\n        </ul>\r\n        {preview ?\r\n          <div className={`${style.layer} ${(animation === 0.5 || animation === -0.5) ? style.transition : null}`} data-flex='main:center cross:center' onClick={this.hideLayer}\r\n          onTransitionEnd={this.transEnd} style={{ opacity: (animation === 0.5 || animation === 1) ? 1 : 0 }}>\r\n              {/* transition 这不能选择0.5，因为0.5是从last(0)变到first(0.5)的过程,而应该选择1(dom已经处于first的位置)开始动画*/}\r\n            <div className={`${style.putPositionItem} ${(animation === 1 || animation === -0.5) ? style.transition : null}`} data-flex='main:center cross:center' ref={this.previewBlock}\r\n              onTransitionEnd={this.transEnd}\r\n                //    难点在这里\r\n                //    animation === 0 的时候要translate3d(0,0,0) scale(1) 来获取last的位置信息\r\n                //    animation === 0.5 的时候这时候flip动画还没有触发，将初始位置移动到firts的位置\r\n                //    animation === 1 的开始flip动画，但是animation == 1 是由layer的animation === 0.5的transEnd触发的，所以要等layer出现后可以\r\n              style={{\r\n                background: `#${pickItem.color}`, width: pickItem.width, height: pickItem.height,\r\n                transform: (animation === 0.5 || animation === -0.5) ? `translate3d(${first.left - last.left}px, ${first.top - last.top}px, 0) scale(1)`\r\n                  : (animation === 0 ? 'translate3d(0,0,0) scale(1)' : 'translate3d(0,0,0) scale(2)')\r\n              }}>\r\n              {pickItem.width} X {pickItem.height}</div>\r\n          </div>\r\n          : null\r\n        }\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Flip;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/project/flip-preview/demo/index.jsx","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/project/flip-preview/demo/index.scss\n// module id = 1777\n// module chunks = 20","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"._2ZjhzTmjUwOeo0LnX5EMQ6 {\\n  color: #fff;\\n  border-radius: 10px;\\n  position: relative;\\n  font-size: 16px;\\n  transition: all .3s;\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif; }\\n\\n._2ZjhzTmjUwOeo0LnX5EMQ6::before {\\n  content: ' ';\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n  opacity: 0;\\n  cursor: pointer;\\n  border-radius: 10px;\\n  background-color: rgba(0, 0, 0, 0.5);\\n  transition: all .3s;\\n  z-index: 1; }\\n\\n._2ZjhzTmjUwOeo0LnX5EMQ6:hover::before {\\n  opacity: 1; }\\n\\n._3ZVbDqjfrubjsnsPD4QytN {\\n  color: #fff;\\n  border-radius: 10px;\\n  position: relative;\\n  font-size: 16px;\\n  transition: all .3s;\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif; }\\n\\n.vOwH_a3gMXCPAd3y-a5bc {\\n  color: #fff;\\n  border-radius: 10px;\\n  position: relative;\\n  font-size: 16px;\\n  transform-origin: 50% 50%;\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif; }\\n\\n._1TggPbx27590G5zLj4u4ib {\\n  transition: all .36s ease-in-out; }\\n\\n.BJguMPrGImpdxcFMue6rq {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  opacity: 0;\\n  background-color: rgba(0, 0, 0, 0.8);\\n  transition: all .3s ease-in-out;\\n  z-index: 1000; }\\n\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"blockItem\": \"_2ZjhzTmjUwOeo0LnX5EMQ6\",\n\t\"pickItem\": \"_3ZVbDqjfrubjsnsPD4QytN\",\n\t\"putPositionItem\": \"vOwH_a3gMXCPAd3y-a5bc\",\n\t\"transition\": \"_1TggPbx27590G5zLj4u4ib\",\n\t\"layer\": \"BJguMPrGImpdxcFMue6rq\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/sass-loader/lib/loader.js!./src/project/flip-preview/demo/index.scss\n// module id = 1778\n// module chunks = 20"],"sourceRoot":""}